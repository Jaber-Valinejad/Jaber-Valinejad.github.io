<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Advanced RAG &amp; Flow Enginering | Jaber Valinejad </title> <meta name="author" content="Jaber Valinejad"> <meta name="description" content="AI-powered social knowledge graph, integrating LLMs, RAG, and clustering pipelines to connect and recommend rare disease specialists."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jaber-valinejad.github.io/projects/1_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">Jaber</span> Valinejad </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item "> <a class="nav-link" href="/projects%20js/">projects21 </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Advanced RAG &amp; Flow Enginering</h1> <p class="post-description">AI-powered social knowledge graph, integrating LLMs, RAG, and clustering pipelines to connect and recommend rare disease specialists.</p> </header> <article> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/z11-480.webp 480w,/assets/img/z11-800.webp 800w,/assets/img/z11-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/z11.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="AI-Driven Rare Disease Research Collaborative Network" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> The Rare Disease Research Collaborative Network (RCN) leverages LangGraph to orchestrate a dynamic AI-powered social knowledge graph. </div> <hr> <h2 id="1-introduction">1. Introduction</h2> <p>Rare diseases (RDs) affect millions globally, yet research efforts remain fragmented due to limited collaboration and access to specialists. Patients often face long diagnostic delays, and researchers may work in isolation without access to peers with complementary expertise. To address these issues, we developed a Rare Disease Research Collaborative Network (RCN) that integrates data from PubMed, NIH grants, and clinical trials into a knowledge graph using Neo4j.</p> <p>By leveraging social network analysis and large language models (LLMs), we cluster researchers based on shared contributions and extract their expertise using prompt-based summarization methods. The result is a labeled, clustered RCN (lc-RCN) that supports both collaboration and specialist recommendation.</p> <h2 id="2-key-questions-addressed">2. Key Questions Addressed</h2> <ul> <li>How can social network analysis and LLMs improve researcher collaboration in rare disease research?</li> <li>What are the optimal strategies for clustering and summarizing researcher expertise?</li> <li>How can we generate fine-tuned and explainable expert recommendations based on user queries?</li> <li>What evaluation methods best capture the quality of expert extraction and summarization?</li> </ul> <h2 id="3-the-problem">3. The Problem</h2> <p>Rare disease research is hampered by several issues:</p> <ul> <li> <strong>Fragmented Networks</strong>: Researchers often work in silos without awareness of nearby or relevant collaborators.</li> <li> <strong>Diagnostic Delays</strong>: Patients lack access to researchers with relevant expertise.</li> <li> <strong>Limited Labelled Data</strong>: Difficulty in labeling expert domains at scale.</li> <li> <strong>Suboptimal Collaboration Tools</strong>: Existing platforms don’t integrate modern AI-driven insights or local geographic mapping.</li> </ul> <h2 id="4-the-importance">4. The Importance</h2> <p>By automating the discovery of researcher expertise and mapping collaborative relationships, RCN:</p> <ul> <li>Enhances RD research by fostering interdisciplinary connections.</li> <li>Improves patient outcomes via access to informed specialists.</li> <li>Informs funding and policy decisions through data-driven network visualization.</li> <li>Enables targeted exploration of research themes and gaps.</li> </ul> <h2 id="5-the-solution">5. The Solution</h2> <h3 id="51-data-collection-and-graph-modeling">5.1 Data Collection and Graph Modeling</h3> <ul> <li>Collected over 6M PubMed authors, 76K grant PIs, and 100K clinical trial investigators from RDAS.</li> <li>Constructed a knowledge graph in Neo4j using nodes for researchers, projects, trials, and publications.</li> <li>Added geographic data using FIPS and coordinates to support proximity-based collaboration.</li> </ul> <h3 id="52-researcher-clustering-c-rcn">5.2 Researcher Clustering (c-RCN)</h3> <ul> <li>Applied DBSCAN with SVD-based dimensionality reduction on research abstracts.</li> <li>Compared clustering against alternatives like K-Means and community detection.</li> </ul> <h3 id="53-expertise-summarization-with-llms-lc-rcn">5.3 Expertise Summarization with LLMs (lc-RCN)</h3> <ul> <li>Tested various prompt engineering methods: <ul> <li>Direct prompting</li> <li>Chain of Thought (CoT)</li> <li>Self-Consistency CoT</li> <li>Self-Feedback with iterative refinement</li> </ul> </li> <li>Fine-tuned LLaMA 3 using LoRA for PEFT-based adaptation.</li> <li>Enhanced inference speed with Key-Value Caching.</li> </ul> <h3 id="54-prompt-engineering-evaluation">5.4 Prompt Engineering Evaluation</h3> <ul> <li>Evaluated output quality with metrics: ROUGE, BERTScore, MoverScore, BLANC, and QuestEval.</li> <li>CoT outperformed others in both semantic similarity and factual fidelity.</li> </ul> <h2 id="6-specialist-recommendation-pipeline">6. Specialist Recommendation Pipeline</h2> <h3 id="61-retrieval-augmented-generation-rag">6.1 Retrieval-Augmented Generation (RAG)</h3> <ul> <li>Stored summarized expertise in a vector store using Langchain + Chroma.</li> <li>Queried vector store and retrieved matched researchers using Neo4j Cypher.</li> <li>Generated final recommendations through augmented prompts.</li> </ul> <h3 id="62-agent-based-query-parsing">6.2 Agent-Based Query Parsing</h3> <ul> <li>Built agents using langchain_core to parse open-ended patient/researcher queries.</li> <li>Extracted relevant symptoms or research areas, mapped them to expertise keywords, and retrieved specialists.</li> <li>Added memory and reasoning to handle informal input like:<br> <em>“I’ve been having muscle weakness and liver dysfunction. Any idea what’s going on?”</em> </li> </ul> <h2 id="7-results-and-impact">7. Results and Impact</h2> <ul> <li>Constructed a graph with 3 million researchers, 12,354 labeled expertise areas.</li> <li>Clustered RD researchers into 3,927 groups with unique expertise tags.</li> <li>Recommended specialists with high semantic similarity (&gt;0.79 BERTScore).</li> <li>Discovered key collaboration hubs and isolated nodes.</li> <li>Enabled U.S.-based geographic mapping using affiliation FIPS codes.</li> </ul> <h2 id="8-skills-and-tools-used">8. Skills and Tools Used</h2> <h3 id="large-language-models-llms">Large Language Models (LLMs)</h3> <ul> <li>OpenAI GPT (GPT-3.5-turbo, GPT-4o)</li> <li>Meta LLaMA-3 (PEFT + LoRA)</li> <li>Claude, Gemini, Phi, Mistral, DeepSeek</li> </ul> <h3 id="prompt-engineering--fine-tuning">Prompt Engineering &amp; Fine-Tuning</h3> <ul> <li>SmartLLMChain, Chain-of-Thought (CoT), Self-Consistency, Self-Feedback</li> <li>Customized expert summarization with RAG pipelines</li> <li>LoRA-based fine-tuning using Unsloth and HuggingFace</li> </ul> <h3 id="cloud-computing-and-scalability">Cloud Computing and Scalability</h3> <ul> <li>Amazon SageMaker for scalable LLM inference, training jobs, and experiment tracking</li> <li>AWS EC2 for heavy lifting in graph analytics and visualization</li> <li>Neo4j AuraDB for managed graph database integration</li> </ul> <h3 id="retrieval-augmented-generation-rag">Retrieval-Augmented Generation (RAG)</h3> <ul> <li>Langchain + Chroma for vector search</li> <li>Cypher-based real-time specialist retrieval from Neo4j</li> </ul> <h3 id="nlp-evaluation-and-metrics">NLP Evaluation and Metrics</h3> <ul> <li>ROUGE, BERTScore, MoverScore, BLANC, QuestEval</li> </ul> <h3 id="data-science--preprocessing">Data Science &amp; Preprocessing</h3> <ul> <li>Pandas, Scikit-learn, SpaCy, NLTK</li> <li>Clustering via DBSCAN, dimensionality reduction via SVD</li> </ul> <h3 id="visualization--analysis">Visualization &amp; Analysis</h3> <ul> <li>NetworkX, Matplotlib for social graphs and cluster maps</li> <li>PageRank, hub/authority scoring, and geographic mapping</li> </ul> <h3 id="deployment">Deployment</h3> <ul> <li>Dockerized workflow for reproducibility</li> <li>APIs for Gradio-based UIs and Langchain agents</li> </ul> <h2 id="9-future-directions">9. Future Directions</h2> <ul> <li>Incorporate PubMedBERT with STSB + GARD fine-tuning for better similarity scoring.</li> <li>Build a web UI to support patient queries and matchmaking.</li> <li>Integrate location-aware filters for proximity-based specialist recommendation.</li> <li>Explore multi-modal data integration (e.g., OMIM, genetic profiles).</li> <li>Improve name disambiguation and organizational record linkage.</li> </ul> <h2 id="10-generative-ai-capabilities">10. Generative AI Capabilities</h2> <p>This project exemplifies the generative AI lifecycle for domain-specific data science use cases in rare disease research:</p> <ul> <li> <strong>Contextual Embedding Generation</strong>: Summarizes research background using LLMs via custom prompts</li> <li> <strong>Information Retrieval</strong>: Retrieves experts with semantically matched embeddings</li> <li> <strong>Text Generation and Summarization</strong>: Converts structured knowledge into natural language responses</li> <li> <strong>Self-Improving Feedback Loops</strong>: Uses self-feedback agents to iteratively refine keyword outputs</li> <li> <strong>Performance Evaluation</strong>: Evaluates generation outputs with multiple semantic and factual metrics</li> <li> <strong>Data Science Integration</strong>: Uses statistical, clustering, and geographic methods to analyze collaboration dynamics</li> </ul> </article> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 Jaber Valinejad. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>