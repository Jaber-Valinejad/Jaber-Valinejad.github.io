<!DOCTYPE html> <html lang="en"> <head> <meta http-equiv="Content-Type" content="text/html; charset=UTF-8"> <meta charset="utf-8"> <meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no"> <meta http-equiv="X-UA-Compatible" content="IE=edge"> <title> Thyroid Follow-Up Study | You R. Name </title> <meta name="author" content="You R. Name"> <meta name="description" content="Thyroid Nodule Progression Analysis Using IBM MarketScan and Azure Databricks."> <meta name="keywords" content="jekyll, jekyll-theme, academic-website, portfolio-website"> <link rel="stylesheet" href="/assets/css/bootstrap.min.css?a4b3f509e79c54a512b890d73235ef04"> <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/css/mdb.min.css" integrity="sha256-jpjYvU3G3N6nrrBwXJoVEYI/0zw8htfFnhT9ljN3JJw=" crossorigin="anonymous"> <link defer rel="stylesheet" href="/assets/css/academicons.min.css?f0b7046b84e425c55f3463ac249818f5"> <link defer rel="stylesheet" href="/assets/css/scholar-icons.css?62b2ac103a88034e6882a5be5f3e2772"> <link defer rel="stylesheet" type="text/css" href="https://fonts.googleapis.com/css?family=Roboto:300,400,500,700|Roboto+Slab:100,300,400,500,700|Material+Icons&amp;display=swap"> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-github.css?591dab5a4e56573bf4ef7fd332894c99" media="" id="highlight_theme_light"> <link rel="shortcut icon" href="data:image/svg+xml,&lt;svg%20xmlns=%22http://www.w3.org/2000/svg%22%20viewBox=%220%200%20100%20100%22&gt;&lt;text%20y=%22.9em%22%20font-size=%2290%22&gt;%E2%9A%9B%EF%B8%8F&lt;/text&gt;&lt;/svg&gt;"> <link rel="stylesheet" href="/assets/css/main.css?d41d8cd98f00b204e9800998ecf8427e"> <link rel="canonical" href="https://jaber-valinejad.github.io/projects/7_project/"> <script src="/assets/js/theme.js?9a0c749ec5240d9cda97bc72359a72c0"></script> <link defer rel="stylesheet" href="/assets/css/jekyll-pygments-themes-native.css?5847e5ed4a4568527aa6cfab446049ca" media="none" id="highlight_theme_dark"> <script>
    initTheme();
  </script> </head> <body class="fixed-top-nav "> <header> <nav id="navbar" class="navbar navbar-light navbar-expand-sm fixed-top" role="navigation"> <div class="container"> <a class="navbar-brand title font-weight-lighter" href="/"> <span class="font-weight-bold">You</span> R. Name </a> <button class="navbar-toggler collapsed ml-auto" type="button" data-toggle="collapse" data-target="#navbarNav" aria-controls="navbarNav" aria-expanded="false" aria-label="Toggle navigation"> <span class="sr-only">Toggle navigation</span> <span class="icon-bar top-bar"></span> <span class="icon-bar middle-bar"></span> <span class="icon-bar bottom-bar"></span> </button> <div class="collapse navbar-collapse text-right" id="navbarNav"> <ul class="navbar-nav ml-auto flex-nowrap"> <li class="nav-item "> <a class="nav-link" href="/">about </a> </li> <li class="nav-item active"> <a class="nav-link" href="/projects/">projects <span class="sr-only">(current)</span> </a> </li> <li class="nav-item "> <a class="nav-link" href="/repositories/">repositories </a> </li> <li class="nav-item "> <a class="nav-link" href="/people/">people </a> </li> <li class="nav-item dropdown "> <a class="nav-link dropdown-toggle" href="#" id="navbarDropdown" role="button" data-toggle="dropdown" aria-haspopup="true" aria-expanded="false">submenus </a> <div class="dropdown-menu dropdown-menu-right" aria-labelledby="navbarDropdown"> <a class="dropdown-item " href="/books/">bookshelf</a> <div class="dropdown-divider"></div> <a class="dropdown-item " href="/blog/">blog</a> </div> </li> <li class="nav-item"> <button id="search-toggle" title="Search" onclick="openSearchModal()"> <span class="nav-link">ctrl k <i class="ti ti-search"></i></span> </button> </li> <li class="toggle-container"> <button id="light-toggle" title="Change theme"> <i class="ti ti-sun-moon" id="light-toggle-system"></i> <i class="ti ti-moon-filled" id="light-toggle-dark"></i> <i class="ti ti-sun-filled" id="light-toggle-light"></i> </button> </li> </ul> </div> </div> </nav> <progress id="progress" value="0"> <div class="progress-container"> <span class="progress-bar"></span> </div> </progress> </header> <div class="container mt-5" role="main"> <div class="post"> <header class="post-header"> <h1 class="post-title">Thyroid Follow-Up Study</h1> <p class="post-description">Thyroid Nodule Progression Analysis Using IBM MarketScan and Azure Databricks.</p> </header> <article> <div class="row justify-content-sm-center"> <div class="col-sm-8 mt-3 mt-md-0"> <figure> <picture> <source class="responsive-img-srcset" srcset="/assets/img/z7-480.webp 480w,/assets/img/z7-800.webp 800w,/assets/img/z7-1400.webp 1400w," type="image/webp" sizes="95vw"></source> <img src="/assets/img/z7.png" class="img-fluid rounded z-depth-1" width="100%" height="auto" title="AI-Driven Rare Disease Research Collaborative Network" loading="eager" onerror="this.onerror=null; $('.responsive-img-srcset').remove();"> </picture> </figure> </div> </div> <div class="caption"> Scalable claims-based analysis of thyroid nodule diagnosis, treatment trends, and healthcare costs using longitudinal modeling and statistical methods. </div> <hr> <h1 id="1-introduction">1. Introduction</h1> <p>Thyroid nodules are a prevalent condition, with many cases requiring careful monitoring and potential surgical intervention. Understanding their progression and the associated treatment patterns is critical for informed clinical decisions. This project analyzes real-world data from IBM MarketScan to uncover insights into thyroid nodule management over time, including population-level trends, comorbidities, and follow-up behaviors. The study leverages distributed computing on Azure Databricks and PySpark to handle and analyze this large-scale claims data efficiently.</p> <h1 id="2-key-questions-addressed">2. Key Questions Addressed</h1> <ul> <li>How do benign and malignant thyroid nodules differ in progression, treatment, and cost?</li> <li>What follow-up patterns emerge over 5 and 10 years for benign cases?</li> <li>What are the most common procedures and their distribution over time?</li> <li>How does insurance type or demographic profile affect treatment decisions?</li> <li>What comorbidities commonly occur in patients with thyroid nodules?</li> </ul> <h1 id="3-the-problem-limitations-in-claims-based-thyroid-research">3. The Problem: Limitations in Claims-Based Thyroid Research</h1> <ul> <li> <strong>Data Volume</strong>: MarketScan data contains millions of inpatient and outpatient claims, requiring efficient distributed filtering and transformation.</li> <li> <strong>Sparse Progression Labels</strong>: Disease progression must be inferred from changes in diagnosis and procedure codes over time.</li> <li> <strong>Procedure Duplication</strong>: Temporal proximity and redundant claims needed to be resolved via customized deduplication algorithms.</li> <li> <strong>Incomplete Coverage</strong>: MarketScan does not include Medicare, Medicaid, or uninsured populations, necessitating adjustments using external population data.</li> <li> <strong>Insurance Impact</strong>: Assessing how insurance type affects care delivery remains a critical equity-focused angle.</li> </ul> <h1 id="4-the-importance-enabling-data-driven-decision-making">4. The Importance: Enabling Data-Driven Decision-Making</h1> <ul> <li> <strong>Improved Risk Stratification</strong>: By identifying patterns in benign-to-malignant transitions (~9.26% observed), clinicians can better manage follow-up intensity.</li> <li> <strong>Surgical Trends</strong>: Insights into procedure timing (e.g., lobectomy, thyroidectomy) support better planning and intervention strategies.</li> <li> <strong>Cost Transparency</strong>: Coinsurance, copayment, and deductible data help visualize financial burdens and payer impact.</li> <li> <strong>Policy Implications</strong>: Findings offer evidence for insurance-related disparities and resource allocation.</li> </ul> <h1 id="5-the-solution-longitudinal-modeling-with-pyspark-and-databricks">5. The Solution: Longitudinal Modeling with PySpark and Databricks</h1> <h2 id="51-data-preprocessing--integration">5.1 Data Preprocessing &amp; Integration</h2> <ul> <li>Filtered 394,632 patients with thyroid nodules from 100M+ records using diagnosis and procedure codes.</li> <li>Addressed data inconsistencies, null values, and redundant claims using PySpark transformations.</li> <li>Adjusted for populations not covered by MarketScan using publicly available uninsured/Medicare/Medicaid statistics.</li> </ul> <h2 id="52-feature-engineering--eda">5.2 Feature Engineering &amp; EDA</h2> <ul> <li>Defined diagnosis progression labels: benign, malignant, benign-to-malignant.</li> <li>Computed follow-up duration, procedure timelines, surgery intervals, and patient demographics.</li> <li>Segmentations based on age, sex, insurance plan, and region.</li> </ul> <h2 id="53-longitudinal-and-predictive-modeling">5.3 Longitudinal and Predictive Modeling</h2> <ul> <li>Gantt charts and stratified survival analysis for benign cases with 5 and 10 years of follow-up.</li> <li>Time-to-surgery intervals modeled from first diagnosis.</li> <li>Custom classification of surgery type (lobectomy vs. total thyroidectomy) and cost pre- and post-surgery.</li> </ul> <h2 id="54-comorbidity-and-procedure-analysis">5.4 Comorbidity and Procedure Analysis</h2> <ul> <li>Tracked coexisting conditions: diabetes, hypertension, hyperlipidemia, sleep apnea, heart disease, RA, pulmonary disorders.</li> <li>Frequency distributions and cost analysis of key procedures: ultrasound, FNA, thyroidectomy variants, calcitonin tests.</li> </ul> <h2 id="55-visualization-and-reporting">5.5 Visualization and Reporting</h2> <p>Constructed dashboards and figures summarizing:</p> <ul> <li>Procedure distributions</li> <li>Progression outcomes</li> <li>Insurance plan and demographic breakdowns</li> <li>Gantt timelines for follow-up and surgery</li> </ul> <h1 id="6-results-and-outcomes">6. Results and Outcomes</h1> <table> <thead> <tr> <th>Metric</th> <th>Value</th> </tr> </thead> <tbody> <tr> <td>Total Patients with Thyroid Nodules</td> <td>394,632</td> </tr> <tr> <td>Benign Cases (≥5 years)</td> <td>7,320</td> </tr> <tr> <td>Benign Cases (≥10 years)</td> <td>3,241</td> </tr> <tr> <td>Benign to Malignant Progression</td> <td>~9.26%</td> </tr> <tr> <td>Mean Follow-up (Benign)</td> <td>4.87 years</td> </tr> <tr> <td>Top Procedures</td> <td>Ultrasound, FNA, Thyroidectomy</td> </tr> <tr> <td>Comorbidity Tracking</td> <td>8+ conditions segmented by sex and age</td> </tr> </tbody> </table> <h1 id="7-conclusion">7. Conclusion</h1> <p>This project provides a scalable and reproducible pipeline for analyzing thyroid nodule progression using real-world claims data. Through rigorous preprocessing, longitudinal modeling, and cost analysis, it enables clinical, financial, and policy insights from large, complex datasets. The use of Azure Databricks and PySpark allows for efficient computation, making it applicable to other high-volume healthcare analytics tasks.</p> <h1 id="8-skills-and-tools-used">8. Skills and Tools Used</h1> <ul> <li> <strong>Distributed Processing</strong>: Azure Databricks, PySpark</li> <li> <strong>Statistical Modeling</strong>: Time-series, survival analysis</li> <li> <strong>Data Wrangling</strong>: Pandas, NumPy</li> <li> <strong>Visualization</strong>: Matplotlib, Plotly, Seaborn</li> <li> <strong>Healthcare Data</strong>: IBM MarketScan</li> <li> <strong>Insurance Estimation</strong>: National policy statistics, data fusion techniques</li> <li> <strong>Procedural Deduplication</strong>: Custom temporal sequence matching algorithms</li> </ul> <h1 id="9-future-directions">9. Future Directions</h1> <ul> <li>Expand to Other Diagnoses: Include autoimmune and thyroid-related metabolic disorders.</li> <li>Geographic Variation: Map treatment patterns across US regions.</li> <li>Link with External Datasets: Add EHR or cancer registry data for richer outcomes.</li> <li>Procedure Pathway Optimization: Suggest optimal follow-up pathways based on historical outcomes.</li> <li>Equity Analysis: Deeper exploration of disparities across insurance types and socioeconomic factors.</li> </ul> </article> <h2>References</h2> <div class="publications"> </div> </div> </div> <footer class="fixed-bottom" role="contentinfo"> <div class="container mt-0"> © Copyright 2025 You R. Name. Powered by <a href="https://jekyllrb.com/" target="_blank" rel="external nofollow noopener">Jekyll</a> with <a href="https://github.com/alshedivat/al-folio" rel="external nofollow noopener" target="_blank">al-folio</a> theme. Hosted by <a href="https://pages.github.com/" target="_blank" rel="external nofollow noopener">GitHub Pages</a>. Photos from <a href="https://unsplash.com" target="_blank" rel="external nofollow noopener">Unsplash</a>. </div> </footer> <script src="https://cdn.jsdelivr.net/npm/jquery@3.6.0/dist/jquery.min.js" integrity="sha256-/xUj+3OJU5yExlq6GSYGSHk7tPXikynS7ogEvDej/m4=" crossorigin="anonymous"></script> <script src="/assets/js/bootstrap.bundle.min.js"></script> <script src="https://cdn.jsdelivr.net/npm/mdbootstrap@4.20.0/js/mdb.min.js" integrity="sha256-NdbiivsvWt7VYCt6hYNT3h/th9vSTL4EDWeGs5SN3DA=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/masonry-layout@4.2.2/dist/masonry.pkgd.min.js" integrity="sha256-Nn1q/fx0H7SNLZMQ5Hw5JLaTRZp0yILA/FRexe19VdI=" crossorigin="anonymous"></script> <script defer src="https://cdn.jsdelivr.net/npm/imagesloaded@5.0.0/imagesloaded.pkgd.min.js" integrity="sha256-htrLFfZJ6v5udOG+3kNLINIKh2gvoKqwEhHYfTTMICc=" crossorigin="anonymous"></script> <script defer src="/assets/js/masonry.js?a0db7e5d5c70cc3252b3138b0c91dcaf" type="text/javascript"></script> <script defer src="https://cdn.jsdelivr.net/npm/medium-zoom@1.1.0/dist/medium-zoom.min.js" integrity="sha256-ZgMyDAIYDYGxbcpJcfUnYwNevG/xi9OHKaR/8GK+jWc=" crossorigin="anonymous"></script> <script defer src="/assets/js/zoom.js?85ddb88934d28b74e78031fd54cf8308"></script> <script src="/assets/js/no_defer.js?2781658a0a2b13ed609542042a859126"></script> <script defer src="/assets/js/common.js?e0514a05c5c95ac1a93a8dfd5249b92e"></script> <script defer src="/assets/js/copy_code.js?12775fdf7f95e901d7119054556e495f" type="text/javascript"></script> <script defer src="/assets/js/jupyter_new_tab.js?d9f17b6adc2311cbabd747f4538bb15f"></script> <script async src="https://d1bxh8uas1mnw7.cloudfront.net/assets/embed.js"></script> <script async src="https://badge.dimensions.ai/badge.js"></script> <script defer type="text/javascript" id="MathJax-script" src="https://cdn.jsdelivr.net/npm/mathjax@3.2.2/es5/tex-mml-chtml.js" integrity="sha256-MASABpB4tYktI2Oitl4t+78w/lyA+D7b/s9GEP0JOGI=" crossorigin="anonymous"></script> <script src="/assets/js/mathjax-setup.js?a5bb4e6a542c546dd929b24b8b236dfd"></script> <script defer src="https://cdnjs.cloudflare.com/polyfill/v3/polyfill.min.js?features=es6" crossorigin="anonymous"></script> <script defer src="/assets/js/progress-bar.js?2f30e0e6801ea8f5036fa66e1ab0a71a" type="text/javascript"></script> <script src="/assets/js/vanilla-back-to-top.min.js?f40d453793ff4f64e238e420181a1d17"></script> <script>
    addBackToTop();
  </script> <script type="module" src="/assets/js/search/ninja-keys.min.js?a3446f084dcaecc5f75aa1757d087dcf"></script> <ninja-keys hidebreadcrumbs noautoloadmdicons placeholder="Type to start searching"></ninja-keys> <script src="/assets/js/search-setup.js?6c304f7b1992d4b60f7a07956e52f04a"></script> <script src="/assets/js/search-data.js"></script> <script src="/assets/js/shortcut-key.js?6f508d74becd347268a7f822bca7309d"></script> </body> </html>